## Терминология
* **Image** — образ, на основе которого будет запущен контейнер
* **Docker Daemon** — фоновый сервис, который создаёт, запускает и управляет контейнерами
* **Docker Client** — терминальная утилита, позволяющая взаимодействовать с Docker Daemon
* **Docker Hub** — репозиторий с образами

## Команды
### Загрузка образа из репозитория Docker
```
$ docker pull <image_name>
```

### Список загруженных образов
```
$ docker images
```

### Запуск контейнера
```
$ docker run <image_name> <command>
```
1. Docker находит образ `<image_name>` и запускает контейнер с ним
2. В контейнере выполняется команда `<command>`
3. Контейнер завершается

Запуск контейнера и работа с ним через `sh`:
```
$ docker run -it <image_name> sh
```
Параметры команды `docker run`:
* `-d` — "открепить" терминал (запуск контейнера в фоновом режиме)
* `-P` — публикация портов
* `--name <name>` — задание названия контейнеру
* `-p <port>:<tcp_port>` — запуск контейнера с кастомным портом

Остановка "откреплённого" контейнера:
```
$ docker stop <container_id>
```

### Список контейнеров
Контейнеры, запущенные в данный момент:
```
$ docker ps
```
История запуска контейнеров:
```
$ docker ps -a
```

### Удаление контейнеров
```
$ docker rm <container_id> <container_id> ...
```
Удаляет контейнеры с **id** `<container_id>`

Удаление неиспользуемых контейнеров:
```
$ docker rm $(docker ps -a -q -f status=exited)
```

### Просмотр портов контейнера
```
$ docker port <name>
```
`<name>` — имя контейнера

### Создание образа
```
docker build <path>
```
Создаёт образ на основе **Dockerfile**

`<path>` — директория или URL, по которому расположен **Dockerfile**

Если **Dockerfile** содержит несколько стадий билда, выбрать конкретную стадию можно параметром `--target`:
```
docker build --target production-env .
```

### Публикация локального образа в Docker Hub
Перед публикацией нужно войти в систему с помощью `docker login`
```
docker push <image_name>
```

## Dockerfile
### FROM
```
FROM <image_name>:<version>
```
Устанавливает базовый образ `<image_name>` версии `<version>`
### ARG
```
ARG <argument>=<value>
```
Переменная с названием `<argument>` и значением `<value>`

Пример использования `ARG`:
```
ARG VERSION=latest
FROM busybox:$VERSION
```
### RUN
```
RUN <command>
```
Запускает внутри контейнера комманду `<command>`

По умолчанию используется оболочка `/bin/sh -c`

Если команда содержит несколько строк, в конце каждой из них нужно ставить символ `\`
### LABEL
```
LABEL <key>=<value> <key>=<value> ...
```
Добавляет образу метаданные с ключом `<key>` со значеним `<value>`

Просмотреть метаданные образа можно командой `docker inspect <image_name>`
### EXPOSE
```
EXPOSE <port>/<protocol>
```
Обозначает порт, прослушиваемый контейнером

Эти порты следует указать при выполнении `docker run`
### ENV
```
ENV <key> <value>
ENV <key>=<value> <key>=<value> ...
```
Задаёт переменной окружения `<key>` значение `<value>`
### CMD
```
CMD ["<executable>","<param>","<param>"]
```
Выполняет команду `<executable>`  с параметром `<param>`









